{"version":3,"sources":["../src/BezierEditor.js"],"names":["onEnterHandle","h","state","down","setState","hover","onDownHandle","e","preventDefault","window","addEventListener","onDownMove","onDownUp","onLeaveHandle","BezierEditor","onEnterHandle1","bind","onEnterHandle2","onLeaveHandle1","onLeaveHandle2","onDownHandle1","onDownHandle2","onDownLeave","i","value","concat","props","positionForEvent","x","y","inversex","inversey","onChange","removeEventListener","rect","refs","root","getBoundingClientRect","clientX","left","clientY","top","padding","w","width","Math","round","max","min","height","handleRadius","clampMargin","style","className","progress","handleStroke","background","gridColor","curveColor","curveWidth","handleColor","textStyle","progressColor","readOnly","pointers","sharedProps","xFrom","yFrom","xTo","yTo","cursor","propTypes","styles","def","userSelect","WebkitUserSelect","MozUserSelect","containerEvents","onMouseLeave","handle1Events","onMouseDown","onMouseEnter","handle2Events","defaultProps","children","undefined","array","func","number","object","string","color","bool","fontFamily","fontSize"],"mappings":"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","file":"BezierEditor.js","sourcesContent":["import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport Grid from \"./Grid\";\nimport Handle from \"./Handle\";\nimport Progress from \"./Progress\";\nimport Curve from \"./Curve\";\n\nfunction onEnterHandle(h) {\n  if (!this.state.down) {\n    this.setState({\n      hover: h,\n    });\n  }\n}\nfunction onDownHandle(h, e) {\n  e.preventDefault();\n  this.setState({\n    hover: null,\n    down: h,\n  });\n  window.addEventListener('mousemove', this.onDownMove);\n  window.addEventListener('mouseup', this.onDownUp);\n}\n\nfunction onLeaveHandle() {\n  if (!this.state.down) {\n    this.setState({\n      hover: null,\n    });\n  }\n}\n\nexport default class BezierEditor extends Component {\n  static propTypes = {\n    value: PropTypes.array,\n    onChange: PropTypes.func,\n    width: PropTypes.number,\n    height: PropTypes.number,\n    padding: PropTypes.array,\n    handleRadius: PropTypes.number,\n    style: PropTypes.object,\n    className: PropTypes.string,\n    progress: PropTypes.number,\n    handleStroke: PropTypes.number,\n    background: PropTypes.string,\n    gridColor: PropTypes.string,\n    curveColor: PropTypes.string,\n    curveWidth: PropTypes.number,\n    handleColor: PropTypes.string,\n    color: PropTypes.string,\n    textStyle: PropTypes.object,\n    progressColor: PropTypes.string,\n    readOnly: PropTypes.bool,\n  };\n\n  static defaultProps = {\n    value: [0.25, 0.25, 0.75, 0.75],\n    width: 300,\n    height: 300,\n    padding: [25, 5, 25, 18],\n    progress: 0,\n    background: \"#fff\",\n    color: \"#000\", // FIXME what is color?\n    gridColor: \"#eee\",\n    curveColor: \"#333\",\n    progressColor: \"#ccc\",\n    handleColor: \"#f00\",\n    curveWidth: 2,\n    handleRadius: 5,\n    handleStroke: 2,\n    textStyle: {\n      fontFamily: \"sans-serif\",\n      fontSize: \"10px\",\n    },\n    pointers: {\n      down: \"none\",\n      hover: \"pointer\",\n      def: \"default\",\n    },\n  };\n\n  state = {\n    down: 0,\n    hover: 0,\n  };\n\n  onEnterHandle1 = onEnterHandle.bind(this, 1);\n  onEnterHandle2 = onEnterHandle.bind(this, 2);\n  onLeaveHandle1 = onLeaveHandle.bind(this, 1);\n  onLeaveHandle2 = onLeaveHandle.bind(this, 2);\n  onDownHandle1 = onDownHandle.bind(this, 1);\n  onDownHandle2 = onDownHandle.bind(this, 2);\n\n  onDownLeave = e => {\n    if (this.state.down) {\n      this.onDownMove(e);\n      this.setState({\n        down: null,\n      });\n    }\n  };\n\n  onDownMove = e => {\n    if (this.state.down) {\n      e.preventDefault();\n      const i = 2 * (this.state.down - 1);\n      const value = [].concat(this.props.value);\n      const [x, y] = this.positionForEvent(e);\n      value[i] = this.inversex(x);\n      value[i + 1] = this.inversey(y);\n      this.props.onChange(value);\n    }\n  };\n\n  onDownUp = () => {\n    window.removeEventListener('mousemove', this.onDownMove);\n    window.removeEventListener('mouseup', this.onDownUp);\n    // this.onDownMove(e);\n    this.setState({\n      down: 0,\n    });\n  };\n\n  positionForEvent = e => {\n    const rect = this.refs.root.getBoundingClientRect();\n    return [e.clientX - rect.left, e.clientY - rect.top];\n  };\n\n  x = value => {\n    const padding = this.props.padding;\n    const w = this.props.width - padding[1] - padding[3];\n    return Math.round(padding[3] + value * w);\n  };\n\n  inversex = x => {\n    const padding = this.props.padding;\n    const w = this.props.width - padding[1] - padding[3];\n    return Math.max(0, Math.min((x - padding[3]) / w, 1));\n  };\n\n  y = value => {\n    const padding = this.props.padding;\n    const h = this.props.height - padding[0] - padding[2];\n    return Math.round(padding[0] + (1 - value) * h);\n  };\n\n  inversey = y => {\n    const { height, handleRadius, padding } = this.props;\n    const clampMargin = 2 * handleRadius;\n    const h = height - padding[0] - padding[2];\n    y = Math.max(clampMargin, Math.min(y, height - clampMargin));\n    return 1 - (y - padding[0]) / h;\n  };\n\n  render() {\n    const { x, y } = this;\n    const {\n      value,\n      width,\n      height,\n      handleRadius,\n      style,\n      className,\n      progress,\n      handleStroke,\n      background,\n      gridColor,\n      curveColor,\n      curveWidth,\n      handleColor,\n      textStyle,\n      progressColor,\n      readOnly,\n      pointers,\n    } = this.props;\n\n    const { down, hover } = this.state;\n\n    const sharedProps = {\n      xFrom: x(0),\n      yFrom: y(0),\n      xTo: x(1),\n      yTo: y(1),\n    };\n\n    const cursor = { ...BezierEditor.propTypes.pointers, ...pointers };\n\n    const styles = {\n      background,\n      cursor: down ? cursor.down : hover ? cursor.hover : cursor.def,\n      userSelect: \"none\",\n      WebkitUserSelect: \"none\",\n      MozUserSelect: \"none\",\n      ...style,\n    };\n\n    const containerEvents = readOnly || !down\n      ? {}\n      : {\n          // onMouseMove: this.onDownMove,\n          // onMouseUp: this.onDownUp,\n          onMouseLeave: this.onDownLeave,\n        };\n    const handle1Events = readOnly || down\n      ? {}\n      : {\n          onMouseDown: this.onDownHandle1,\n          onMouseEnter: this.onEnterHandle1,\n          onMouseLeave: this.onLeaveHandle1,\n        };\n    const handle2Events = readOnly || down\n      ? {}\n      : {\n          onMouseDown: this.onDownHandle2,\n          onMouseEnter: this.onEnterHandle2,\n          onMouseLeave: this.onLeaveHandle2,\n        };\n\n    return (\n      <svg\n        ref=\"root\"\n        className={className}\n        style={styles}\n        width={width}\n        height={height}\n        {...containerEvents}\n      >\n        <Grid\n          {...sharedProps}\n          background={background}\n          gridColor={gridColor}\n          textStyle={{ ...BezierEditor.defaultProps.textStyle, ...textStyle }}\n        />\n        <Progress\n          {...sharedProps}\n          value={value}\n          progress={progress}\n          progressColor={progressColor}\n        />\n        <Curve\n          {...sharedProps}\n          value={value}\n          curveColor={curveColor}\n          curveWidth={curveWidth}\n        />\n        {this.props.children}\n        {readOnly\n          ? undefined\n          : <g>\n              <Handle\n                {...sharedProps}\n                {...handle1Events}\n                index={0}\n                xval={value[0]}\n                yval={value[1]}\n                handleRadius={handleRadius}\n                handleColor={handleColor}\n                down={down === 1}\n                hover={hover === 1}\n                handleStroke={handleStroke}\n                background={background}\n              />\n              <Handle\n                {...sharedProps}\n                {...handle2Events}\n                index={1}\n                xval={value[2]}\n                yval={value[3]}\n                handleRadius={handleRadius}\n                handleColor={handleColor}\n                down={down === 2}\n                hover={hover === 2}\n                handleStroke={handleStroke}\n                background={background}\n              />\n            </g>}\n      </svg>\n    );\n  }\n}\n"]}